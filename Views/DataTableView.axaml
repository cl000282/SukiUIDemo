<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:suki="https://github.com/kikipoulet/SukiUI"
             xmlns:local="clr-namespace:SukiUIDemo.Models"
             xmlns:vm="clr-namespace:SukiUIDemo.ViewModels"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True"
             x:DataType="vm:DataTableViewModel"
             x:Class="SukiUIDemo.Views.DataTableView">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- 标题和操作按钮 -->
        <StackPanel Grid.Row="0" Spacing="15" x:DataType="vm:DataTableViewModel">
            <TextBlock Text="数据表格展示" FontSize="24" FontWeight="Bold" />
            
            <suki:GlassCard>
                <StackPanel Spacing="15">
                    <TextBlock Text="表格操作" FontSize="16" FontWeight="SemiBold" />
                    
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <Button Content="添加10条数据" Command="{Binding AddSampleDataCommand}" CommandParameter="10" />
                        <Button Content="添加10万条数据" Command="{Binding AddSampleDataCommand}" CommandParameter="100000" />
                        <Button Content="清空数据" Command="{Binding ClearDataCommand}" />
                        <Button Content="展开所有行" Command="{Binding ExpandAllRowsCommand}" />
                        <Button Content="折叠所有行" Command="{Binding CollapseAllRowsCommand}" />
                    </StackPanel>
                    
                    <TextBlock Text="{Binding StatusText}" />
                </StackPanel>
            </suki:GlassCard>
        </StackPanel>
        
        <!-- 表格区域 -->
        <suki:GlassCard Grid.Row="1" Margin="0,15,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="产品数据表格（支持子表展开）" FontSize="16" FontWeight="SemiBold" Margin="10" />
                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                    <DataGrid ItemsSource="{Binding Products}"
                              AutoGenerateColumns="False"
                              CanUserReorderColumns="True"
                              CanUserSortColumns="True"
                              IsReadOnly="True">                        
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="80" />
                            <DataGridTextColumn Header="产品名称" Binding="{Binding Name}" Width="200" />
                            <DataGridTextColumn Header="分类" Binding="{Binding Category}" Width="120" />
                            <DataGridTextColumn Header="价格" Binding="{Binding Price, StringFormat='¥{0:F2}'}" Width="100" />
                            <DataGridTextColumn Header="库存" Binding="{Binding Stock}" Width="80" />
                            <DataGridCheckBoxColumn Header="状态" Binding="{Binding IsActive}" Width="80" />
                        </DataGrid.Columns>
                        
                        <DataGrid.RowDetailsTemplate>
                            <DataTemplate x:DataType="local:Product">
                                <Border Background="#f8f9fa" Margin="10" Padding="10" CornerRadius="5">
                                    <StackPanel>
                                        <TextBlock Text="订单详情" FontSize="14" FontWeight="Bold" Margin="0,0,0,10" />
                                        
                                        <DataGrid ItemsSource="{Binding Orders}" 
                                                  AutoGenerateColumns="False"
                                                  IsReadOnly="True"
                                                  HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="订单ID" Binding="{Binding OrderId}" Width="80" />
                                                <DataGridTextColumn Header="订单日期" Binding="{Binding OrderDate, StringFormat='yyyy-MM-dd'}" Width="120" />
                                                <DataGridTextColumn Header="数量" Binding="{Binding Quantity}" Width="80" />
                                                <DataGridTextColumn Header="总金额" Binding="{Binding TotalAmount, StringFormat='¥{0:F2}'}" Width="100" />
                                                <DataGridTextColumn Header="状态" Binding="{Binding Status}" Width="100" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </DataGrid.RowDetailsTemplate>
                    </DataGrid>
                </ScrollViewer>
            </Grid>
        </suki:GlassCard>
    </Grid>
</UserControl>